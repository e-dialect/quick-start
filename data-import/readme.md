# 数据导入指南（语保版）

中国语言资源保护工程使用标准化的方式记录各地方言数据，这里提供标准化的数据导入方式，方便各地语保资料快速导入。

## 前置准备

### 词汇数据

语保工程里提供了最基础的词汇数据，其格式包括了：

- 编号：该词汇的序号
- 普通话：该词汇的普通话表达
- 方言：该词汇的方言表达
- 发音：该词汇的方言发音，以IPA方式记录
- 注释：该方言词汇的注释、常见用法等

为了方便后续读取，采用`tsv`格式存储。

>  如何产生tsv文件，语言保护的excel表格输出另存为选 txt 按 unicode 输出 txt 文件就是。

### 语音数据

语保中的语音数据默认是`flv`格式，需要转化为`mp3`格式。

>  程序本身不限制语音数据的格式，转化格式只是便于在用户端播放。
>
>  一种可能的批量转化方式是使用脚本批量执行 `ffmpeg` 的转化程序。
>
>  ```shell
>  ffmpeg -i 方言老男词汇/0001太阳.flv -q:a 5 方言老男词汇mp3/0001太阳.flv.mp3
>  ```

实际上，语音数据最终是以`URL`的形式存在于系统中，因此可以使用自己的CDN网站，或直接使用后端自带的文件服务能力。

> 将语音数据放在后端仓库中的`media`文件夹内就可以在`https://your-backend.com/files/`中直接使用。

## 导入数据

### 数据库导入脚本 `sql.js`

1. 指定词汇数据和语音数据的路径，使用 `node` 执行SQL语句产生脚本`sql.js`，得到词汇数据导入`word.sql`和词汇数据导入`pron.sql`。
2. 使用一些数据库软件，在后端服务器的数据库中执行两个`sql`文件。

### 接口导入脚本

指定词汇数据和语音数据的路径，执行指定脚本（暂缺）即可导入。